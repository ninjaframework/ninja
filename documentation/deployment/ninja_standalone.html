<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/documentation/deployment/ninja_standalone.md at 2023-12-07
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20231207" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Ninja &#x2013; Ninja standalone</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.7.min.js"></script>
<meta name="description"
                  content="Ninja is a full stack web framework for Java.
                    Rock solid, fast and super productive."/>
            <link rel="icon" type="image/png" href="favicon.png" />

            <link href='//fonts.googleapis.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'/>
            <link href='//fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'/>
            <link href='//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'/>

            <script type="text/javascript">

                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-38154034-1']);
                _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();

            </script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/ninjaframework/ninja">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="../../.." id="bannerLeft" title="Ninja web framework"><img src="../../ninja_logo.png"  alt="Ninja web framework"/></a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2023-12-07</li>
          <li id="projectVersion" class="pull-right">Version: 7.0.1-SNAPSHOT</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Introduction</li>
    <li><a href="../../introduction.html" title="The problem we solve"><span class="none"></span>The problem we solve</a></li>
    <li><a href="../../high_level_overview.html" title="Ninja - high level overview"><span class="none"></span>Ninja - high level overview</a></li>
    <li><a href="../../team.html" title="The team"><span class="none"></span>The team</a></li>
      <li class="nav-header">Commercial support</li>
    <li><a href="../../commercial_support/philosophy.html" title="Philosophy"><span class="none"></span>Philosophy</a></li>
    <li><a href="../../commercial_support/training.html" title="Training"><span class="none"></span>Training</a></li>
    <li><a href="../../commercial_support/support_plans.html" title="Support plans"><span class="none"></span>Support plans</a></li>
    <li><a href="../../commercial_support/agile_custom_development.html" title="Custom development"><span class="none"></span>Custom development</a></li>
      <li class="nav-header">Documentation</li>
    <li><a href="../../documentation/getting_started/installing_ninja.html" title="Getting Started"><span class="icon-chevron-right"></span>Getting Started</a></li>
    <li><a href="../../documentation/basic_concepts/basic_concepts.html" title="Basic concepts"><span class="icon-chevron-right"></span>Basic concepts</a></li>
    <li><a href="../../documentation/configuration_and_modes.html" title="Configuration and modes"><span class="none"></span>Configuration and modes</a></li>
    <li><a href="../../documentation/html_templating/getting_started.html" title="HTML templating"><span class="icon-chevron-right"></span>HTML templating</a></li>
    <li><a href="../../documentation/working_with_json_jsonp.html" title="Working with JSON / JSONP"><span class="none"></span>Working with JSON / JSONP</a></li>
    <li><a href="../../documentation/working_with_xml.html" title="Working with XML"><span class="none"></span>Working with XML</a></li>
      <li class="nav-header">Advanced topics</li>
    <li><a href="../../documentation/websockets.html" title="Web Sockets"><span class="none"></span>Web Sockets</a></li>
    <li><a href="../../documentation/validation.html" title="Validation"><span class="none"></span>Validation</a></li>
    <li><a href="../../documentation/content_negotiation.html" title="Content negotiation"><span class="none"></span>Content negotiation</a></li>
    <li><a href="../../documentation/uploading_files.html" title="Uploading files"><span class="none"></span>Uploading files</a></li>
    <li><a href="../../documentation/scheduler.html" title="Scheduler"><span class="none"></span>Scheduler</a></li>
    <li><a href="../../documentation/lifecycle.html" title="Lifecycle"><span class="none"></span>Lifecycle</a></li>
    <li><a href="../../documentation/working_with_relational_dbs/jpa.html" title="Working with relational DBs"><span class="icon-chevron-right"></span>Working with relational DBs</a></li>
    <li><a href="../../documentation/using_the_cache.html" title="Using the cache"><span class="none"></span>Using the cache</a></li>
    <li><a href="../../documentation/internationalization.html" title="Internationalization"><span class="none"></span>Internationalization</a></li>
    <li><a href="../../documentation/static_assets.html" title="Static assets"><span class="none"></span>Static assets</a></li>
    <li><a href="../../documentation/sending_mail.html" title="Sending mail"><span class="none"></span>Sending mail</a></li>
    <li><a href="../../documentation/logging.html" title="Logging"><span class="none"></span>Logging</a></li>
    <li><a href="../../documentation/custom_routing.html" title="Custom routing"><span class="none"></span>Custom routing</a></li>
    <li><a href="../../documentation/servlet_bridge.html" title="Servlet bridge"><span class="none"></span>Servlet bridge</a></li>
    <li><a href="../../documentation/console.html" title="Console application"><span class="none"></span>Console application</a></li>
    <li><a href="../../documentation/testing_your_application/getting_started.html" title="Testing"><span class="icon-chevron-right"></span>Testing</a></li>
    <li><a href="../../documentation/debugging.html" title="Debugging"><span class="none"></span>Debugging</a></li>
    <li><a href="../../documentation/security/getting_started.html" title="Security"><span class="none"></span>Security</a></li>
    <li><a href="../../documentation/deployment/getting_started.html" title="Deployment"><span class="icon-chevron-down"></span>Deployment</a>
    <ul class="nav nav-list">
    <li class="active"><a href="#"><span class="none"></span>Ninja standalone</a></li>
    <li><a href="../../documentation/deployment/multi_module_maven_project.html" title="Multi module maven project"><span class="none"></span>Multi module maven project</a></li>
    <li><a href="../../documentation/deployment/war_based_deployment.html" title="War based deployment"><span class="none"></span>War based deployment</a></li>
    <li><a href="../../documentation/deployment/cloud_hosting_options.html" title="Cloud hosting options"><span class="none"></span>Cloud hosting options</a></li>
    </ul>
</li>
    <li><a href="../../documentation/upgrade_guide.html" title="Upgrade guide"><span class="none"></span>Upgrade guide</a></li>
    <li><a href="../../apidocs/index.html" title="API docs (JavaDoc)"><span class="none"></span>API docs (JavaDoc)</a></li>
      <li class="nav-header">Ninja Modules</li>
    <li><a href="../../documentation/modules.html" title="Overview"><span class="none"></span>Overview</a></li>
      <li class="nav-header">Great community</li>
    <li><a href="https://twitter.com/ninjaframework" class="externalLink" title="@ninjaframework"><span class="none"></span>@ninjaframework</a></li>
    <li><a href="https://groups.google.com/d/forum/ninja-framework" class="externalLink" title="Mailing list"><span class="none"></span>Mailing list</a></li>
    <li><a href="https://github.com/ninjaframework/ninja" class="externalLink" title="Source code"><span class="none"></span>Source code</a></li>
    <li><a href="https://github.com/ninjaframework/ninja/issues" class="externalLink" title="Bug tracker"><span class="none"></span>Bug tracker</a></li>
    <li><a href="../../security.html" title="Security issues"><span class="none"></span>Security issues</a></li>
      <li class="nav-header">For developers</li>
    <li><a href="../../developer/changelog.html" title="Changelog"><span class="none"></span>Changelog</a></li>
    <li><a href="../../developer/roadmap.html" title="Roadmap"><span class="none"></span>Roadmap</a></li>
    <li><a href="../../developer/getting_started.html" title="How to contribute"><span class="none"></span>How to contribute</a></li>
</ul>
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="https://www.ninjaframework.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript">asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
    <div id="twitter">
    <a href="https://twitter.com/ninjaframework" class="twitter-follow-button" data-show-count="true" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow ninjaframework</a>
    <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span9" >
<h1>Ninja standalone</h1><section>
<h2><a name="Introduction"></a>Introduction</h2>
<p>Ninja features a standalone mode where you do not need a separate servlet container.
The standalone mode enables you to package your application along with
a fast, embedded HTTP server (Jetty in that case).  There are several options for
packaging your application using standalone mode.</p></section><section>
<h2><a name="Option_1_-_Uber.2FFat_Jar_using_Assembly_Maven_Plugin"></a>Option 1 - Uber/Fat Jar using Assembly Maven Plugin</h2>
<p>This allows you to drop that self-executing file to your server run your application
with zero external dependencies.
Due to Ninja's client-side sessions it becomes really simple to have one
reverse proxy in front of many Ninja instances.</p>
<p>In order to do so you have to first of all add ninja-standalone as dependency to your pom.xml:</p>

<div class="source">
<pre class="prettyprint">
&lt;dependency&gt;
    &lt;groupId&gt;org.ninjaframework&lt;/groupId&gt;
    &lt;artifactId&gt;ninja-standalone&lt;/artifactId&gt;
    &lt;version&gt;X.X.X&lt;/version&gt;
&lt;/dependency&gt;
</pre></div>

<p>Don't forget to change packaging value from <i>war</i> to <i>jar</i>.</p>

<div class="source">
<pre class="prettyprint">
&lt;packaging&gt;jar&lt;/packaging&gt;
</pre></div>

<p>Packaging the application is done via the maven shade plugin. Add the following snipplet
to your pom.xml.</p>

<div class="source">
<pre class="prettyprint">
&lt;plugin&gt;
  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
  &lt;version&gt;2.2&lt;/version&gt;
  &lt;configuration&gt;
    &lt;createDependencyReducedPom&gt;true&lt;/createDependencyReducedPom&gt;
    &lt;filters&gt;
      &lt;filter&gt;
        &lt;artifact&gt;*:*&lt;/artifact&gt;
        &lt;excludes&gt;
          &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;
          &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;
          &lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;
        &lt;/excludes&gt;
      &lt;/filter&gt;
    &lt;/filters&gt;
  &lt;/configuration&gt;
  &lt;executions&gt;
    &lt;execution&gt;
      &lt;phase&gt;package&lt;/phase&gt;
      &lt;goals&gt;
        &lt;goal&gt;shade&lt;/goal&gt;
      &lt;/goals&gt;
      &lt;configuration&gt;
        &lt;transformers&gt;
          &lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ServicesResourceTransformer&quot;/&gt;
          &lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt;
            &lt;mainClass&gt;ninja.standalone.NinjaJetty&lt;/mainClass&gt;
          &lt;/transformer&gt;
        &lt;/transformers&gt;
      &lt;/configuration&gt;
    &lt;/execution&gt;
  &lt;/executions&gt;
&lt;/plugin&gt;
</pre></div>

<p>Whenever you build your application on the command line this will generate a fat jar
inside your target directory. Usually that file is named roughly MY-APPLICATION-jar-with-dependencies.jar</p>
<p>You can generate the fat jar by calling</p>

<div class="source">
<pre class="prettyprint">
mvn clean compile package
</pre></div>

<p>Running the fat jar (and your app) is as simple as calling:</p>

<div class="source"><pre class="prettyprint linenums">
java -Dninja.port=9000 -jar MY-APPLICATION-jar-with-dependencies.jar
</pre></div>

<p><b>Incompatibility notice</b></p>
<p>Please be aware that since Ninja 6.4.3, alongside with Jetty 9.4.12, the dependency allowing Jetty servlets annotations (that should not be
useful for your Ninja Framework project) have been excluded from the stack. This was caused by an incompatibility between the version
of the java bytecode handler <code>ASM</code> used by this module (6.2) and the java bytecode handler <code>javassist</code> used by Hibernate.</p></section><section>
<h2><a name="Option_2_-_Packaged_using_Stork_Maven_Plugin"></a>Option 2 - Packaged using Stork Maven Plugin</h2>
<p>If you'd like to run your application as a proper daemon on Unix/Mac or as a service
on Windows, another option is using the <a class="externalLink" href="https://github.com/fizzed/java-stork">Stork Maven Plugin</a>.</p>
<p>Stork is a collection of utilities for optimizing your &#x201c;after-build&#x201d; workflow by
filling in the gap between Maven and eventual app execution. In just a couple
quick steps, stork will package your Ninja app into a professional .tar.gz
file ready for deployment.</p>
<p>Here is an <a class="externalLink" href="http://fizzed.com/blog/2015/01/using-stork-deploy-production-ninja-framework-app">article describing how Ninja apps can be packaged with Stork</a>.</p>
<p>Here is a <a class="externalLink" href="https://github.com/fizzed/java-ninja-stork-demo">demo application that integrates with Stork</a>.</p></section><section>
<h2><a name="Command-line_.2F_system_property_configuration"></a>Command-line / system property configuration</h2>
<p>Regardless of which option you choose, you can customize your application startup
via the following command line parameters:</p>
<ul>

<li><code>ninja.port</code> allows you to select the port on which your
application is starting (8080 by default).</li>
<li><code>ninja.host</code> allows you to select the host on which your
application will bind (any/0.0.0.0 by default).</li>
<li><code>ninja.idle.timeout</code> allows you to specify the timeout period after which
idle HTTP connections will be closed. (in msec, 30000 by default)</li>
<li><code>ninja.mode</code> allows you to select the mode (test, dev, prod)
of your application (prod by default).</li>
<li><code>ninja.external.configuration</code> allows you to add an external application
configuration (eg -Dninja.external.configuration=conf/production.conf).
Please note that even with an external configuration, if you included a
<code>conf/application.conf</code> on your classpath (e.g. in your app jar)
then it will be loaded first, followed by the external configuration file.
By using both files, you'll only need to worry about overriding values &#x2013;
which comes in handy when running in test/production environments.</li>
<li><code>ninja.context</code> allows you to add a context prefix to your application
(eg -Dninja.context=/your_context_path).</li>
<li><code>ninja.jetty.configuration</code> allows you to supply a comma-delimited
list of <code>jetty.xml</code> configuration files to configure the server.
Anything Jetty can do is now available. Please note that if this property is
supplied then the host/port property is skipped and you'll need to configure
that in the <code>jetty.xml</code> configuration file.
(eg -Dninja.jetty.configuration=jetty.xml,jetty-ssl.xml) Please refer to
Jetty distribution for example config files.  For each jetty configuration file
the local filesystem is searched first, followed by the classpath, and if
multiple files are included then each one is applied in order.</li>
</ul></section><section>
<h2><a name="Init.d_script_to_run_Ninja_as_standalone_service_on_Linux"></a>Init.d script to run Ninja as standalone service on Linux</h2>
<p>If you use option #1 and want to register your Ninja standalone application on
your Linux box (Debian, Ubuntu) you can use and adapt the following script. The
script should be copied at /etc/init.d/ninja and can be run via <code>service ninja start</code>.</p>

<div class="source">
<pre class="prettyprint">
#!/bin/bash
# chkconfig: 345 20 80
# description: Ninja start/shutdown script
# processname: java
#
# Installation:
# copy file to /etc/init.d
# chmod +x /etc/init.d/ninja

# chkconfig --add /etc/init.d/ninja
# chkconfig ninja on
#     OR on a Debian system
# sudo update-rc.d ninja defaults

#
# Usage: (as root)
# service ninja start
# service ninja stop
# service ninja status
#
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #

# Path to the application
APPLICATION_NAME=my-ninja-service
APPLICATION_PATH=/srv/ninja_applications/${APPLICATION_NAME}
APPLICATION_JAR=my-ninja-service-1.0-SNAPSHOT-jar-with-dependencies.jar

PID_FILE=/var/run/${APPLICATION_NAME}.pid
PORT=9013

# Path to the JVM
JAVA_BIN=/opt/java-oracle/jdk1.7.0/bin/java
PARAMS=&quot;-Dninja.port=${PORT} -jar ${APPLICATION_PATH}/${APPLICATION_JAR}&quot;

# User running the Ninja process
USER=ninja

RETVAL=0

start() {
    if [ -f ${PID_FILE} ]; then
        echo &quot;Ninja application ${APPLICATION_NAME} already running&quot;
    else
        DAEMON_START_LINE=&quot;start-stop-daemon --chdir=${APPLICATION_PATH} --make-pidfile --pidfile ${PID_FILE} --chuid ${USER} --exec ${JAVA_BIN} --background --start -- ${PARAMS}&quot;
        ${DAEMON_START_LINE}
        RETVAL=$?
        echo -n &quot;Starting Ninja Application: ${APPLICATION_NAME}... &quot;


            if [ $RETVAL -eq 0 ]; then
                echo &quot; - Success&quot;
            else
                echo &quot; - Failure&quot;
            fi
        echo
    fi
    echo

}
stop() {
    kill -9 `cat ${PID_FILE}`
    RETVAL=$?
    rm -rf ${PID_FILE}
    echo -n &quot;Stopping Ninja application: ${APPLICATION_NAME}&quot;

    if [ $RETVAL -eq 0 ]; then
        echo &quot; - Success&quot;
    else
        echo &quot; - Failure&quot;
    fi
        echo
    }

status() {
    if [ -f ${PID_FILE} ]; then
        echo &quot;Ninja application ${APPLICATION_NAME} running&quot;
    else
        echo &quot;Ninja application ${APPLICATION_NAME} not running&quot;
    fi
    echo

}

clean() {
        rm -f ${PID_FILE}
}

case &quot;$1&quot; in
    start)
    start
    ;;
    stop)
    stop
    ;;
    restart|reload)
    stop
    sleep 10
    start
    ;;
    status)
    status
    ;;
    clean)
    clean
    ;;
*)
echo &quot;Usage: $0 {start|stop|restart|status}&quot;
esac
</pre></div></section>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2023
<a href="https://www.ninjaframework.org">ninjaframework</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
