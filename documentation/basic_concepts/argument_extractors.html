<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/documentation/basic_concepts/argument_extractors.md at 2023-12-07
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20231207" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Ninja &#x2013; Argument extractors</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.7.min.js"></script>
<meta name="description"
                  content="Ninja is a full stack web framework for Java.
                    Rock solid, fast and super productive."/>
            <link rel="icon" type="image/png" href="favicon.png" />

            <link href='//fonts.googleapis.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'/>
            <link href='//fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'/>
            <link href='//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'/>

            <script type="text/javascript">

                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-38154034-1']);
                _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();

            </script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/ninjaframework/ninja">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="../../.." id="bannerLeft" title="Ninja web framework"><img src="../../ninja_logo.png"  alt="Ninja web framework"/></a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2023-12-07</li>
          <li id="projectVersion" class="pull-right">Version: 7.0.1-SNAPSHOT</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Introduction</li>
    <li><a href="../../introduction.html" title="The problem we solve"><span class="none"></span>The problem we solve</a></li>
    <li><a href="../../high_level_overview.html" title="Ninja - high level overview"><span class="none"></span>Ninja - high level overview</a></li>
    <li><a href="../../team.html" title="The team"><span class="none"></span>The team</a></li>
      <li class="nav-header">Commercial support</li>
    <li><a href="../../commercial_support/philosophy.html" title="Philosophy"><span class="none"></span>Philosophy</a></li>
    <li><a href="../../commercial_support/training.html" title="Training"><span class="none"></span>Training</a></li>
    <li><a href="../../commercial_support/support_plans.html" title="Support plans"><span class="none"></span>Support plans</a></li>
    <li><a href="../../commercial_support/agile_custom_development.html" title="Custom development"><span class="none"></span>Custom development</a></li>
      <li class="nav-header">Documentation</li>
    <li><a href="../../documentation/getting_started/installing_ninja.html" title="Getting Started"><span class="icon-chevron-right"></span>Getting Started</a></li>
    <li><a href="../../documentation/basic_concepts/basic_concepts.html" title="Basic concepts"><span class="icon-chevron-down"></span>Basic concepts</a>
    <ul class="nav nav-list">
    <li><a href="../../documentation/basic_concepts/super_dev_mode.html" title="SuperDevMode"><span class="none"></span>SuperDevMode</a></li>
    <li><a href="../../documentation/basic_concepts/routing.html" title="Routing"><span class="none"></span>Routing</a></li>
    <li><a href="../../documentation/basic_concepts/controllers.html" title="Controllers"><span class="none"></span>Controllers</a></li>
    <li><a href="../../documentation/basic_concepts/filters.html" title="Filters"><span class="none"></span>Filters</a></li>
    <li class="active"><a href="#"><span class="none"></span>Argument extractors</a></li>
    <li><a href="../../documentation/basic_concepts/dependency_injection.html" title="Dependency injection"><span class="none"></span>Dependency injection</a></li>
    <li><a href="../../documentation/basic_concepts/sessions.html" title="Sessions"><span class="none"></span>Sessions</a></li>
    <li><a href="../../documentation/basic_concepts/flash_scope.html" title="Flash scope"><span class="none"></span>Flash scope</a></li>
    <li><a href="../../documentation/basic_concepts/error_handling.html" title="Error handling"><span class="none"></span>Error handling</a></li>
    <li><a href="../../documentation/basic_concepts/metrics.html" title="Metrics"><span class="none"></span>Metrics</a></li>
    </ul>
</li>
    <li><a href="../../documentation/configuration_and_modes.html" title="Configuration and modes"><span class="none"></span>Configuration and modes</a></li>
    <li><a href="../../documentation/html_templating/getting_started.html" title="HTML templating"><span class="icon-chevron-right"></span>HTML templating</a></li>
    <li><a href="../../documentation/working_with_json_jsonp.html" title="Working with JSON / JSONP"><span class="none"></span>Working with JSON / JSONP</a></li>
    <li><a href="../../documentation/working_with_xml.html" title="Working with XML"><span class="none"></span>Working with XML</a></li>
      <li class="nav-header">Advanced topics</li>
    <li><a href="../../documentation/websockets.html" title="Web Sockets"><span class="none"></span>Web Sockets</a></li>
    <li><a href="../../documentation/validation.html" title="Validation"><span class="none"></span>Validation</a></li>
    <li><a href="../../documentation/content_negotiation.html" title="Content negotiation"><span class="none"></span>Content negotiation</a></li>
    <li><a href="../../documentation/uploading_files.html" title="Uploading files"><span class="none"></span>Uploading files</a></li>
    <li><a href="../../documentation/scheduler.html" title="Scheduler"><span class="none"></span>Scheduler</a></li>
    <li><a href="../../documentation/lifecycle.html" title="Lifecycle"><span class="none"></span>Lifecycle</a></li>
    <li><a href="../../documentation/working_with_relational_dbs/jpa.html" title="Working with relational DBs"><span class="icon-chevron-right"></span>Working with relational DBs</a></li>
    <li><a href="../../documentation/using_the_cache.html" title="Using the cache"><span class="none"></span>Using the cache</a></li>
    <li><a href="../../documentation/internationalization.html" title="Internationalization"><span class="none"></span>Internationalization</a></li>
    <li><a href="../../documentation/static_assets.html" title="Static assets"><span class="none"></span>Static assets</a></li>
    <li><a href="../../documentation/sending_mail.html" title="Sending mail"><span class="none"></span>Sending mail</a></li>
    <li><a href="../../documentation/logging.html" title="Logging"><span class="none"></span>Logging</a></li>
    <li><a href="../../documentation/custom_routing.html" title="Custom routing"><span class="none"></span>Custom routing</a></li>
    <li><a href="../../documentation/servlet_bridge.html" title="Servlet bridge"><span class="none"></span>Servlet bridge</a></li>
    <li><a href="../../documentation/console.html" title="Console application"><span class="none"></span>Console application</a></li>
    <li><a href="../../documentation/testing_your_application/getting_started.html" title="Testing"><span class="icon-chevron-right"></span>Testing</a></li>
    <li><a href="../../documentation/debugging.html" title="Debugging"><span class="none"></span>Debugging</a></li>
    <li><a href="../../documentation/security/getting_started.html" title="Security"><span class="none"></span>Security</a></li>
    <li><a href="../../documentation/deployment/getting_started.html" title="Deployment"><span class="icon-chevron-right"></span>Deployment</a></li>
    <li><a href="../../documentation/upgrade_guide.html" title="Upgrade guide"><span class="none"></span>Upgrade guide</a></li>
    <li><a href="../../apidocs/index.html" title="API docs (JavaDoc)"><span class="none"></span>API docs (JavaDoc)</a></li>
      <li class="nav-header">Ninja Modules</li>
    <li><a href="../../documentation/modules.html" title="Overview"><span class="none"></span>Overview</a></li>
      <li class="nav-header">Great community</li>
    <li><a href="https://twitter.com/ninjaframework" class="externalLink" title="@ninjaframework"><span class="none"></span>@ninjaframework</a></li>
    <li><a href="https://groups.google.com/d/forum/ninja-framework" class="externalLink" title="Mailing list"><span class="none"></span>Mailing list</a></li>
    <li><a href="https://github.com/ninjaframework/ninja" class="externalLink" title="Source code"><span class="none"></span>Source code</a></li>
    <li><a href="https://github.com/ninjaframework/ninja/issues" class="externalLink" title="Bug tracker"><span class="none"></span>Bug tracker</a></li>
    <li><a href="../../security.html" title="Security issues"><span class="none"></span>Security issues</a></li>
      <li class="nav-header">For developers</li>
    <li><a href="../../developer/changelog.html" title="Changelog"><span class="none"></span>Changelog</a></li>
    <li><a href="../../developer/roadmap.html" title="Roadmap"><span class="none"></span>Roadmap</a></li>
    <li><a href="../../developer/getting_started.html" title="How to contribute"><span class="none"></span>How to contribute</a></li>
</ul>
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="https://www.ninjaframework.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript">asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
    <div id="twitter">
    <a href="https://twitter.com/ninjaframework" class="twitter-follow-button" data-show-count="true" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow ninjaframework</a>
    <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span9" >
<h1>Argument extractors</h1><section>
<h2><a name="Injecting_stuff_into_your_controller_-_method_scope"></a>Injecting stuff into your controller - method scope</h2>
<p>Ninja can inject a lot of stuff into your methods by default. For instance
variable parts of routes via <code>@PathParam</code>.
Or query / form parameters via <code>@Param</code> and <code>@Params</code>.</p>
<p>Argument extractors allow you to use the very same mechanism
(annotations of method parameters) to
inject inject arbitrary things into the method of a controller.</p>
<p>This allows you to process a request, extract things
(like a user currently logged in), and provide this via an annotation.</p><section>
<h3><a name="Built-in_Supported_Types"></a>Built-in Supported Types</h3>
<ul>

<li>String</li>
<li>Boolean (boolean)</li>
<li>Byte (byte)</li>
<li>Short (short)</li>
<li>Character (char)</li>
<li>Integer (int)</li>
<li>Long (long)</li>
<li>Float (float)</li>
<li>Double (double)</li>
<li>Enum (any)</li>
<li>Arrays of all these types (e.g. String[], int[], Enum[])</li>
</ul>
<p><b>NOTES:</b></p>
<p>Enums do not require anymore a registration in conf.Module. Values are
converted automatically, ignoring case. Collections and generics are not
supported for parameter injection. Types must be explicitly declared
and basic arrays must be used to ensure runtime type-safety.</p>
<p>By default, empty String parameters will be treated as null values. If you
explicitely need empty strings for empty given parameters, register the
<code>ParamParsers.EmptyStringParamParser</code> in your conf.Module <code>configure()</code> method:</p>

<div class="source">
<pre class="prettyprint">
Multibinder&lt;ParamParser&gt; parsersBinder = Multibinder.newSetBinder(binder(), ParamParser.class);
parsersBinder.addBinding().to(ParamParsers.EmptyStringParamParser.class);
</pre></div>
</section><section>
<h3><a name="Custom_Parameter_Types"></a>Custom Parameter Types</h3>
<p>You can also add your own supported type to Ninja, or override and existing one,
simply by implementing the <code>ParamParser</code> interface and binding it
with Guice in your conf.Module <code>configure()</code> method:</p>

<div class="source">
<pre class="prettyprint">
Multibinder&lt;ParamParser&gt; parsersBinder = Multibinder.newSetBinder(binder(), ParamParser.class);
parsersBinder.addBinding().to(MyParamParser.class);
</pre></div>
</section></section><section>
<h2><a name="How_to_write_an_argument_extractor"></a>How to write an argument extractor</h2>
<p>Let's write an argument extractor that lets us inject the user currently logged in into
our method via an annotation. At the end our controller should look like:</p>

<div class="source">
<pre class="prettyprint">
package controllers;

@Singleton
public class ApplicationController {

    public Result index(
            @LoggedInUser String loggedInUser) {

        //do something with the parameters...
    }

}
</pre></div>

<p>The <code>@LoggedInUser</code> is a so called argument extractor
and allow you to extract arbitrary things out
of the request and re-package them into anything you want.
<code>@LoggedInUser</code> for instance determines
the user and injects the username into the field annotated with <code>@LoggedInUser</code>.</p>
<p>Argument extractors consist of two things: A marker interface and an implementation.</p>
<p>First the marker interface:</p>

<div class="source">
<pre class="prettyprint">
@WithArgumentExtractor(LoggedInUserExtractor.class)
@Retention(RetentionPolicy.RUNTIME)
@Target({ElementType.PARAMETER})
public @interface LoggedInUser {}
</pre></div>

<p>&#x2026; and the argument extractor itself:</p>

<div class="source">
<pre class="prettyprint">
public class LoggedInUserExtractor implements ArgumentExtractor&lt;String&gt; {

    @Override
    public String extract(Context context) {
        
        // if we got no session we break:
        if (context.getSession() != null) {
            
            String username = context.getSession().get(&quot;username&quot;);
            
            return username;
            
        }
        
        return null;
    }

    @Override
    public Class getExtractedType() {
        return String.class;
    }

    @Override
    public String getFieldName() {
        return null;
    }
}
</pre></div>

<p>As you can see the interface of the argument extractor references
<code>@WithArgumentExtractor(LoggedInUserExtractor.class)</code>.
<code>LoggedInUserExtractor</code> itself has full access to the context (and the incoming request)
and will return the object
annotated initially by
<code>@LoggedInUser</code>. In our example this was <code>@LoggedInUser String loggedInUser</code>.</p><section>
<h3><a name="Note:_Using_dependency_injection"></a>Note: Using dependency injection</h3>
<p>Currently, there is a bug that causes <code>@Inject</code> fields to not be injected if you use an empty constructor. The workaround is to create a constructor with an injected parameter, such as <code>Context context</code>.</p>

<div class="source">
<pre class="prettyprint">
public class LoggedInUserExtractor implements ArgumentExtractor&lt;String&gt; {

    @Inject
    public LoggedInUserExtractor(Context context) {}

    @Inject
    UserDao userDao;
    
    ...
    
}
</pre></div></section></section>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2023
<a href="https://www.ninjaframework.org">ninjaframework</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
