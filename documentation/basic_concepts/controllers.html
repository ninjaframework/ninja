<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/markdown/documentation/basic_concepts/controllers.md at 2019-05-16
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190516" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Ninja &#x2013; Controller</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.7.min.js"></script>
<meta name="description"
                  content="Ninja is a full stack web framework for Java.
                    Rock solid, fast and super productive."/>
            <link rel="icon" type="image/png" href="favicon.png" />

            <link href='//fonts.googleapis.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'/>
            <link href='//fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'/>
            <link href='//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'/>

            <script type="text/javascript">

                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-38154034-1']);
                _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();

            </script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/ninjaframework/ninja">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="../../.." id="bannerLeft" title="Ninja web framework"><img src="../../ninja_logo.png"  alt="Ninja web framework"/></a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2019-05-16</li>
          <li id="projectVersion" class="pull-right">Version: 6.5.0</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Introduction</li>
    <li><a href="../../introduction.html" title="The problem we solve"><span class="none"></span>The problem we solve</a></li>
    <li><a href="../../high_level_overview.html" title="Ninja - high level overview"><span class="none"></span>Ninja - high level overview</a></li>
    <li><a href="../../team.html" title="The team"><span class="none"></span>The team</a></li>
      <li class="nav-header">Commercial support</li>
    <li><a href="../../commercial_support/philosophy.html" title="Philosophy"><span class="none"></span>Philosophy</a></li>
    <li><a href="../../commercial_support/training.html" title="Training"><span class="none"></span>Training</a></li>
    <li><a href="../../commercial_support/support_plans.html" title="Support plans"><span class="none"></span>Support plans</a></li>
    <li><a href="../../commercial_support/agile_custom_development.html" title="Custom development"><span class="none"></span>Custom development</a></li>
      <li class="nav-header">Documentation</li>
    <li><a href="../../documentation/getting_started/installing_ninja.html" title="Getting Started"><span class="icon-chevron-right"></span>Getting Started</a></li>
    <li><a href="../../documentation/basic_concepts/basic_concepts.html" title="Basic concepts"><span class="icon-chevron-down"></span>Basic concepts</a>
    <ul class="nav nav-list">
    <li><a href="../../documentation/basic_concepts/super_dev_mode.html" title="SuperDevMode"><span class="none"></span>SuperDevMode</a></li>
    <li><a href="../../documentation/basic_concepts/routing.html" title="Routing"><span class="none"></span>Routing</a></li>
    <li class="active"><a href="#"><span class="none"></span>Controllers</a></li>
    <li><a href="../../documentation/basic_concepts/filters.html" title="Filters"><span class="none"></span>Filters</a></li>
    <li><a href="../../documentation/basic_concepts/argument_extractors.html" title="Argument extractors"><span class="none"></span>Argument extractors</a></li>
    <li><a href="../../documentation/basic_concepts/dependency_injection.html" title="Dependency injection"><span class="none"></span>Dependency injection</a></li>
    <li><a href="../../documentation/basic_concepts/sessions.html" title="Sessions"><span class="none"></span>Sessions</a></li>
    <li><a href="../../documentation/basic_concepts/flash_scope.html" title="Flash scope"><span class="none"></span>Flash scope</a></li>
    <li><a href="../../documentation/basic_concepts/error_handling.html" title="Error handling"><span class="none"></span>Error handling</a></li>
    <li><a href="../../documentation/basic_concepts/metrics.html" title="Metrics"><span class="none"></span>Metrics</a></li>
    </ul>
</li>
    <li><a href="../../documentation/configuration_and_modes.html" title="Configuration and modes"><span class="none"></span>Configuration and modes</a></li>
    <li><a href="../../documentation/html_templating/getting_started.html" title="HTML templating"><span class="icon-chevron-right"></span>HTML templating</a></li>
    <li><a href="../../documentation/working_with_json_jsonp.html" title="Working with JSON / JSONP"><span class="none"></span>Working with JSON / JSONP</a></li>
    <li><a href="../../documentation/working_with_xml.html" title="Working with XML"><span class="none"></span>Working with XML</a></li>
      <li class="nav-header">Advanced topics</li>
    <li><a href="../../documentation/websockets.html" title="Web Sockets"><span class="none"></span>Web Sockets</a></li>
    <li><a href="../../documentation/validation.html" title="Validation"><span class="none"></span>Validation</a></li>
    <li><a href="../../documentation/content_negotiation.html" title="Content negotiation"><span class="none"></span>Content negotiation</a></li>
    <li><a href="../../documentation/uploading_files.html" title="Uploading files"><span class="none"></span>Uploading files</a></li>
    <li><a href="../../documentation/scheduler.html" title="Scheduler"><span class="none"></span>Scheduler</a></li>
    <li><a href="../../documentation/lifecycle.html" title="Lifecycle"><span class="none"></span>Lifecycle</a></li>
    <li><a href="../../documentation/working_with_relational_dbs/jpa.html" title="Working with relational DBs"><span class="icon-chevron-right"></span>Working with relational DBs</a></li>
    <li><a href="../../documentation/using_the_cache.html" title="Using the cache"><span class="none"></span>Using the cache</a></li>
    <li><a href="../../documentation/internationalization.html" title="Internationalization"><span class="none"></span>Internationalization</a></li>
    <li><a href="../../documentation/static_assets.html" title="Static assets"><span class="none"></span>Static assets</a></li>
    <li><a href="../../documentation/sending_mail.html" title="Sending mail"><span class="none"></span>Sending mail</a></li>
    <li><a href="../../documentation/logging.html" title="Logging"><span class="none"></span>Logging</a></li>
    <li><a href="../../documentation/custom_routing.html" title="Custom routing"><span class="none"></span>Custom routing</a></li>
    <li><a href="../../documentation/servlet_bridge.html" title="Servlet bridge"><span class="none"></span>Servlet bridge</a></li>
    <li><a href="../../documentation/console.html" title="Console application"><span class="none"></span>Console application</a></li>
    <li><a href="../../documentation/testing_your_application/getting_started.html" title="Testing"><span class="icon-chevron-right"></span>Testing</a></li>
    <li><a href="../../documentation/debugging.html" title="Debugging"><span class="none"></span>Debugging</a></li>
    <li><a href="../../documentation/security/getting_started.html" title="Security"><span class="none"></span>Security</a></li>
    <li><a href="../../documentation/deployment/getting_started.html" title="Deployment"><span class="icon-chevron-right"></span>Deployment</a></li>
    <li><a href="../../documentation/upgrade_guide.html" title="Upgrade guide"><span class="none"></span>Upgrade guide</a></li>
    <li><a href="../../apidocs/index.html" title="API docs (JavaDoc)"><span class="none"></span>API docs (JavaDoc)</a></li>
      <li class="nav-header">Ninja Modules</li>
    <li><a href="../../documentation/modules.html" title="Overview"><span class="none"></span>Overview</a></li>
      <li class="nav-header">Great community</li>
    <li><a href="https://twitter.com/ninjaframework" class="externalLink" title="@ninjaframework"><span class="none"></span>@ninjaframework</a></li>
    <li><a href="https://groups.google.com/d/forum/ninja-framework" class="externalLink" title="Mailing list"><span class="none"></span>Mailing list</a></li>
    <li><a href="https://github.com/ninjaframework/ninja" class="externalLink" title="Source code"><span class="none"></span>Source code</a></li>
    <li><a href="https://github.com/ninjaframework/ninja/issues" class="externalLink" title="Bug tracker"><span class="none"></span>Bug tracker</a></li>
    <li><a href="../../security.html" title="Security issues"><span class="none"></span>Security issues</a></li>
      <li class="nav-header">For developers</li>
    <li><a href="../../developer/changelog.html" title="Changelog"><span class="none"></span>Changelog</a></li>
    <li><a href="../../developer/roadmap.html" title="Roadmap"><span class="none"></span>Roadmap</a></li>
    <li><a href="../../developer/getting_started.html" title="How to contribute"><span class="none"></span>How to contribute</a></li>
</ul>
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="http://www.ninjaframework.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript">asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
          <hr />
          <div id="poweredBy">
    <script type="text/javascript">asyncJs( 'https://apis.google.com/js/plusone.js' )</script>
    <div class="g-plusone" data-href="http://www.ninjaframework.org/ninja-core" data-size="tall" ></div>
            <div class="clear"></div>
            <div class="clear"></div>
    <div id="twitter">
    <a href="https://twitter.com/ninjaframework" class="twitter-follow-button" data-show-count="true" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow ninjaframework</a>
    <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Controller</h1>
<div class="section">
<h2><a name="Introduction"></a>Introduction</h2>
<p>Controllers are the &#x201c;C&#x201d; in the MVC paradigm. Controllers will do actual stuff. They get requests or part of requests, retrieve stuff from databases and cause Ninja to return certain results.</p></div>
<div class="section">
<h2><a name="A_really_simple_controller"></a>A really simple controller</h2>
<p>A basic controller looks like:</p>

<div>
<pre class="prettyprint">
package controllers;

@Singleton
public class AppController {

    public Result index() {

        return Results.html();
    }

}
</pre></div>

<p>The important conventions are that a controller method must return a <tt>Result</tt>. A result is in short just an object that holds response codes, content to render, headers and cookies that should be returned to the visitors of your website.</p>
<p><tt>Results</tt> with the &#x201c;s&#x201d; at the end is a convenience class that allows you to generate a preconfigured <tt>Result</tt>. For instance <tt>Results.html()</tt> will tell Ninja to render an HTML page. But you can also render JSON and other results.</p>
<p>By convention controllers live in the package &#x201c;controllers&#x201d;.</p></div>
<div class="section">
<h2><a name="Getting_parameters_into_your_controllers"></a>Getting parameters into your controllers</h2>
<p>A controller usually not only renders stuff, but also takes some inputs and does something with them.</p>
<p>You can get parts of the URL inside your controller via three annotations: <tt>@Param</tt>, <tt>@Params</tt> and <tt>@PathParam</tt>. Via @PathParam you can get variable parts of a route (described in more details in the routing section).</p>
<p>@Param allows you to get single-value Query or Form parameters. @Params allows you to get multi-value Query parameters.</p>
<p>Let&#x2019;s say and the user visits the following URL&#x2026;</p>

<div>
<pre class="prettyprint">
/user/12345/my@email.com/userDashboard?debug=false&amp;filters=new&amp;filters=urgent
</pre></div>

<p>&#x2026; and we got a route definition like that:</p>

<div>
<pre class="prettyprint">
router.GET().route(&quot;/user/{id}/{email}/userDashboard&quot;).with(AppController::userDashboard);
</pre></div>

<p>We can then get all variable parts of this URL via the following method controller definition:</p>

<div>
<pre class="prettyprint">
package controllers;

@Singleton
public class AppController {

    public Result userDashboard(
            @PathParam(&quot;id&quot;) String id, 
            @PathParam(&quot;email&quot;) String email, 
            @Param(&quot;debug&quot;) Optional&lt;String&gt; debug,
            @Param(&quot;isAdmin&quot;) Boolean isAdmin,
            @Params(&quot;filters&quot;) String [] filters,
            @Header(&quot;user-agent&quot;) String userAgent) {

        //do something with the parameters...

    }

}

</pre></div>
</div>
<div class="section">
<h2><a name="More_on_objects_Ninja_can_automatically_provide_you_at_controller_level"></a>More on objects Ninja can automatically provide you at controller level</h2>
<p>Have a look at that method:</p>

<div>
<pre class="prettyprint">
package controllers;

@Singleton
public class ApplicationController {

    public Result index(
            @PathParam(&quot;id&quot;) String id, 
            @PathParam(&quot;email&quot;) String email, 
            @Param(&quot;debug&quot;) Optional&lt;String&gt; debug,
            @Param(&quot;isAdmin&quot;) Boolean isAdmin,
            Context context,
            MyObject myObject) {

        //do something with the parameters...
    }

}
</pre></div>

<p>Ninja can not only inject @PathParam and @Param objects. But also the Context. The context is a request scoped object that holds all information of the current request - parameters, headers and so on&#x2026;</p>
<p>Even better: Ninja will parse an arbitrary object given in the method. In the above case MyObject will be automatically parsed by Ninja. The way it will parsed (JSON, XML, POST form) will be determined via the &#x201c;Content-Type&#x201d; request header.</p>
<p>If you are using the POST form way, this object can contains any parameter type listed in the <a class="externalLink" href="http://www.ninjaframework.org/documentation/basic_concepts/argument_extractors.html">Argument extractors</a> chapter (or custom ones, as described in the same chapter). Custom objects contained in this arbitrary object can also be parsed if they have a constructor without arguments.</p>

<div>
<pre class="prettyprint">
public class Address {
    String street;
}

public class User {
    Address address;
}
</pre></div>

<p>Assuming your controller method want to receive a User object, your HTML form can send a field value for the key <tt>address.street</tt>.</p>
<p>If your custom object has a date/timestamp field, first make sure that you use the <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/util/Date.html">java.util.Date</a> type and when you pass some date to the controller pass in the <a class="externalLink" href="http://joda-time.sourceforge.net/api-release/org/joda/time/format/ISODateTimeFormat.html#localDateOptionalTimeParser%28%29">format</a> accepted by Joda Time library, or implement your own <tt>ParamParser</tt> for a java.util.Date.</p></div>
<div class="section">
<h2><a name="A_note_about_null_and_Optional"></a>A note about null and Optional</h2>
<div class="section">
<h3><a name="The_default.2C_but_deprecated_way"></a>The default, but deprecated way</h3>
<p>In the example above we got two parameters: &#x201c;debug&#x201d; and &#x201c;isAdmin&#x201d;. If both parameters are not supplied then debug will be Optional.empty() and isAdmin will be null.</p>
<p>But null has a lot of problems and Optional is the clean solution to say &#x201c;The value may be there - or not&#x201d;. Therefore <b>Ninja will deprecate the usage of null in controller methods from version 7.0.0 onwards</b>.</p>
<p>Ninja makes the transition smooth by providing a configuration variable that allows to control what behavior you want to use. By default the value will be false.</p>

<div>
<pre>
ninja.strict_argument_extractors=false        # accepts null 
</pre></div>
</div>
<div class="section">
<h3><a name="The_new_way_.28Default_from_Ninja_7.0.0.29"></a>The new way (Default from Ninja 7.0.0)</h3>
<p>The new way eliminates the need to check for nulls.</p>
<p>Activate the mode by setting a configuration variable in application.conf:</p>

<div>
<pre>
ninja.strict_argument_extractors=true         # redirects to Bad Request page if parameter is null 
</pre></div>

<p>Then</p>
<ul>

<li>use Optional (eg <tt>Optional&lt;String&gt; debug</tt>) when the parameter may be supplied by the user - or not.</li>
<li>don&#x2019;t use Optional (eg <tt>Boolean isAdmin</tt>) if you expect the parameter to be there. If the parameter is not supplied by a user request then Ninja issues a Bad Request. Your controller method code will never be executed.</li>
</ul></div>
<div class="section">
<h3><a name="How_to_upgrade_from_the_deprecated_way_to_the_new_way"></a>How to upgrade from the deprecated way to the new way</h3>
<p>Make sure you upgrade asap to be compatible with future versions of Ninja.</p>
<p>1) Activate the mode by setting a configuration variable in application.conf:</p>

<div>
<pre>
ninja.strict_argument_extractors=true         # redirects to Bad Request page if parameter is null 
</pre></div>

<p>2) Then investigate all your controller methods.</p>
<p>If you do null checks on parameters that get injected into your controller then change them to Optional. That way you get rid of all null checks.</p>
<p>Things like @PathParam, Context and Session will never be Optional, because Ninja is always able to provide them. But things like @Param or custom argument extractors may well be optional.</p></div></div>
<div class="section">
<h2><a name="Ninja_and_content_negotiation"></a>Ninja and content negotiation</h2>
<p>In the last section we have already seen that parsing of objects works via content negotiation.</p>
<p>Rendering of objects works the same way and evaluates the &#x201c;Accept&#x201d; request header for that.</p>
<p>Therefore a controller method like&#x2026;</p>

<div>
<pre class="prettyprint">
public void Result getUser() {
    User user = userDao.getUser();
    return Results.ok().render(user);
}
</pre></div>

<p>&#x2026;will render XML when the &#x201c;Accept&#x201d; request header is &#x201c;application/xml&#x201d; or JSON when the &#x201c;Accept&#x201d; header is &#x201c;application/json&#x201d;.</p>
<p>While content negotiation is pretty cool it sometimes breaks down in reality.</p>
<p>Especially if clients send strange headers or if you want to be sure that a certain controller method always renders a return format.</p>
<p>Then you can simply call use <tt>return Results.json().render(user)</tt> or <tt>return Results.xml().render(user)</tt> to enforce the rendering of a certain return format.</p></div>
<div class="section">
<h2><a name="Rendering_HTML"></a>Rendering HTML</h2>
<p>Rendering by convention has been already explained in the getting started part. But in short consider the following class:</p>

<div>
<pre class="prettyprint">
package controllers;

public class ApplicationController {       

    public Result index() {
        return Results.html();

    }
}
</pre></div>

<p>This renders by convention a view in directory <tt>views/ApplicationController/index.ftl.html</tt>.</p>
<p>But you can specify your own HTML view, too:</p>

<div>
<pre class="prettyprint">
package controllers;

public class ApplicationController {       

    public Result index() {
        return Results.html().template(&quot;views/AnotherController/anotherview.ftl.html&quot;);

    }
}
</pre></div>

<p>In conclusion you can use convention over configuration in most cases - but you can also specify a view to render explicitly.</p></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2019
<a href="http://www.ninjaframework.org">ninjaframework</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
