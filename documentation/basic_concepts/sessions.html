<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/documentation/basic_concepts/sessions.md at 2023-12-07
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20231207" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Ninja &#x2013; Sessions</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.7.min.js"></script>
<meta name="description"
                  content="Ninja is a full stack web framework for Java.
                    Rock solid, fast and super productive."/>
            <link rel="icon" type="image/png" href="favicon.png" />

            <link href='//fonts.googleapis.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'/>
            <link href='//fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'/>
            <link href='//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'/>

            <script type="text/javascript">

                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-38154034-1']);
                _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();

            </script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/ninjaframework/ninja">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="../../.." id="bannerLeft" title="Ninja web framework"><img src="../../ninja_logo.png"  alt="Ninja web framework"/></a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2023-12-07</li>
          <li id="projectVersion" class="pull-right">Version: 7.0.1-SNAPSHOT</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Introduction</li>
    <li><a href="../../introduction.html" title="The problem we solve"><span class="none"></span>The problem we solve</a></li>
    <li><a href="../../high_level_overview.html" title="Ninja - high level overview"><span class="none"></span>Ninja - high level overview</a></li>
    <li><a href="../../team.html" title="The team"><span class="none"></span>The team</a></li>
      <li class="nav-header">Commercial support</li>
    <li><a href="../../commercial_support/philosophy.html" title="Philosophy"><span class="none"></span>Philosophy</a></li>
    <li><a href="../../commercial_support/training.html" title="Training"><span class="none"></span>Training</a></li>
    <li><a href="../../commercial_support/support_plans.html" title="Support plans"><span class="none"></span>Support plans</a></li>
    <li><a href="../../commercial_support/agile_custom_development.html" title="Custom development"><span class="none"></span>Custom development</a></li>
      <li class="nav-header">Documentation</li>
    <li><a href="../../documentation/getting_started/installing_ninja.html" title="Getting Started"><span class="icon-chevron-right"></span>Getting Started</a></li>
    <li><a href="../../documentation/basic_concepts/basic_concepts.html" title="Basic concepts"><span class="icon-chevron-down"></span>Basic concepts</a>
    <ul class="nav nav-list">
    <li><a href="../../documentation/basic_concepts/super_dev_mode.html" title="SuperDevMode"><span class="none"></span>SuperDevMode</a></li>
    <li><a href="../../documentation/basic_concepts/routing.html" title="Routing"><span class="none"></span>Routing</a></li>
    <li><a href="../../documentation/basic_concepts/controllers.html" title="Controllers"><span class="none"></span>Controllers</a></li>
    <li><a href="../../documentation/basic_concepts/filters.html" title="Filters"><span class="none"></span>Filters</a></li>
    <li><a href="../../documentation/basic_concepts/argument_extractors.html" title="Argument extractors"><span class="none"></span>Argument extractors</a></li>
    <li><a href="../../documentation/basic_concepts/dependency_injection.html" title="Dependency injection"><span class="none"></span>Dependency injection</a></li>
    <li class="active"><a href="#"><span class="none"></span>Sessions</a></li>
    <li><a href="../../documentation/basic_concepts/flash_scope.html" title="Flash scope"><span class="none"></span>Flash scope</a></li>
    <li><a href="../../documentation/basic_concepts/error_handling.html" title="Error handling"><span class="none"></span>Error handling</a></li>
    <li><a href="../../documentation/basic_concepts/metrics.html" title="Metrics"><span class="none"></span>Metrics</a></li>
    </ul>
</li>
    <li><a href="../../documentation/configuration_and_modes.html" title="Configuration and modes"><span class="none"></span>Configuration and modes</a></li>
    <li><a href="../../documentation/html_templating/getting_started.html" title="HTML templating"><span class="icon-chevron-right"></span>HTML templating</a></li>
    <li><a href="../../documentation/working_with_json_jsonp.html" title="Working with JSON / JSONP"><span class="none"></span>Working with JSON / JSONP</a></li>
    <li><a href="../../documentation/working_with_xml.html" title="Working with XML"><span class="none"></span>Working with XML</a></li>
      <li class="nav-header">Advanced topics</li>
    <li><a href="../../documentation/websockets.html" title="Web Sockets"><span class="none"></span>Web Sockets</a></li>
    <li><a href="../../documentation/validation.html" title="Validation"><span class="none"></span>Validation</a></li>
    <li><a href="../../documentation/content_negotiation.html" title="Content negotiation"><span class="none"></span>Content negotiation</a></li>
    <li><a href="../../documentation/uploading_files.html" title="Uploading files"><span class="none"></span>Uploading files</a></li>
    <li><a href="../../documentation/scheduler.html" title="Scheduler"><span class="none"></span>Scheduler</a></li>
    <li><a href="../../documentation/lifecycle.html" title="Lifecycle"><span class="none"></span>Lifecycle</a></li>
    <li><a href="../../documentation/working_with_relational_dbs/jpa.html" title="Working with relational DBs"><span class="icon-chevron-right"></span>Working with relational DBs</a></li>
    <li><a href="../../documentation/using_the_cache.html" title="Using the cache"><span class="none"></span>Using the cache</a></li>
    <li><a href="../../documentation/internationalization.html" title="Internationalization"><span class="none"></span>Internationalization</a></li>
    <li><a href="../../documentation/static_assets.html" title="Static assets"><span class="none"></span>Static assets</a></li>
    <li><a href="../../documentation/sending_mail.html" title="Sending mail"><span class="none"></span>Sending mail</a></li>
    <li><a href="../../documentation/logging.html" title="Logging"><span class="none"></span>Logging</a></li>
    <li><a href="../../documentation/custom_routing.html" title="Custom routing"><span class="none"></span>Custom routing</a></li>
    <li><a href="../../documentation/servlet_bridge.html" title="Servlet bridge"><span class="none"></span>Servlet bridge</a></li>
    <li><a href="../../documentation/console.html" title="Console application"><span class="none"></span>Console application</a></li>
    <li><a href="../../documentation/testing_your_application/getting_started.html" title="Testing"><span class="icon-chevron-right"></span>Testing</a></li>
    <li><a href="../../documentation/debugging.html" title="Debugging"><span class="none"></span>Debugging</a></li>
    <li><a href="../../documentation/security/getting_started.html" title="Security"><span class="none"></span>Security</a></li>
    <li><a href="../../documentation/deployment/getting_started.html" title="Deployment"><span class="icon-chevron-right"></span>Deployment</a></li>
    <li><a href="../../documentation/upgrade_guide.html" title="Upgrade guide"><span class="none"></span>Upgrade guide</a></li>
    <li><a href="../../apidocs/index.html" title="API docs (JavaDoc)"><span class="none"></span>API docs (JavaDoc)</a></li>
      <li class="nav-header">Ninja Modules</li>
    <li><a href="../../documentation/modules.html" title="Overview"><span class="none"></span>Overview</a></li>
      <li class="nav-header">Great community</li>
    <li><a href="https://twitter.com/ninjaframework" class="externalLink" title="@ninjaframework"><span class="none"></span>@ninjaframework</a></li>
    <li><a href="https://groups.google.com/d/forum/ninja-framework" class="externalLink" title="Mailing list"><span class="none"></span>Mailing list</a></li>
    <li><a href="https://github.com/ninjaframework/ninja" class="externalLink" title="Source code"><span class="none"></span>Source code</a></li>
    <li><a href="https://github.com/ninjaframework/ninja/issues" class="externalLink" title="Bug tracker"><span class="none"></span>Bug tracker</a></li>
    <li><a href="../../security.html" title="Security issues"><span class="none"></span>Security issues</a></li>
      <li class="nav-header">For developers</li>
    <li><a href="../../developer/changelog.html" title="Changelog"><span class="none"></span>Changelog</a></li>
    <li><a href="../../developer/roadmap.html" title="Roadmap"><span class="none"></span>Roadmap</a></li>
    <li><a href="../../developer/getting_started.html" title="How to contribute"><span class="none"></span>How to contribute</a></li>
</ul>
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="https://www.ninjaframework.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript">asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
    <div id="twitter">
    <a href="https://twitter.com/ninjaframework" class="twitter-follow-button" data-show-count="true" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow ninjaframework</a>
    <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span9" >
<h1>Sessions</h1><section>
<h2><a name="Introduction"></a>Introduction</h2>
<p>A session is a package of information that always maps to one particular user of your application.
It is persistent over many connects. For instance - A user logs into your application today
and comes back tomorrow. Using sessions you will be able to recognize the connects as belonging to the
same user.</p>
<p>Session handling can be achieved in many ways. PHP and many Java stacks use a cookie with a &#x201c;secret&#x201d; key
that then maps to a session that is stored on a db or filesystem. These approaches are called server side sessions.</p>
<p>Ninja does not do it that way. Instead Ninja uses so called client-side sessions. The cookie itself stores
the information you want to attach to that session. The cool thing is: Scaling Ninja servers becomes
much simpler. You do not need sticky sessions or any filesystem that has to be fast enough to
deliver sessions to your servers. The bad thing is that a Ninja session can only contain very little
information (up to around 4k).</p>
<p>By the way - Ninja did not invent the concept of client side sessions - The praise goes to Rails (afaik).</p>
<p>More on sessions: (<a class="externalLink" href="http://en.wikipedia.org/wiki/Session_(computer_science)">http://en.wikipedia.org/wiki/Session_(computer_science)</a>)</p>

<div class="alert alert-info">
Ninja sessions are not encrypted by default. 
Therefore you should not store any 
critical information. Storing a user id, or username is fine. Storing
credit card information is really bad practice. But if you need to include sensitive data for any reasons,
you can encrypt sessions as described in <a href="/documentation/security/getting_started.html">Security</a>
page.
</div>
</section><section>
<h2><a name="Reading_a_session_value"></a>Reading a session value</h2>
<p>You can access the session inside your controller either by specifying
<code>Session</code> as method parameter. Or by injecting a <code>Context</code> and
accessing the session via <code>context.getSession()</code>.</p>
<p>Accessing individual values is done by calling <code>get(&#x2026;)</code> on the
injected <code>Session</code>.</p>

<div>
<pre class="prettyprint">
public Result getUserNameFromSession(Session session) {

    String username = session.get(&quot;username&quot;);

    return Results.html().render(username);

}
</pre></div>

<p>Individual session values can also be injected in your controller by decorating
method parameters with the <code>@SessionParam(&#x201c;name&#x201d;)</code> annotation.
For example, to get a session value named &#x201c;user_id&#x201d;:</p>

<div>
<pre class="prettyprint">
public Result index(@SessionParam(&quot;user_id&quot;) Long userId) {

    // rest of method

}
</pre></div>
</section><section>
<h2><a name="Saving_data_inside_a_session"></a>Saving data inside a session</h2>
<p>You can store data by using method <code>put(key, value)</code> of the
<code>Session</code> object.</p>

<div>
<pre class="prettyprint">
public Result putUserNameToSession(Session session) {

    session.put(&quot;username&quot;, &quot;kevin&quot;);

    return Results.html();

}
</pre></div>
</section><section>
<h2><a name="Clearing_the_session"></a>Clearing the session</h2>
<p>Session also offers a <code>clear()</code> method that wipes the session.</p>

<div>
<pre class="prettyprint">
public Result clearSession(Session session) {

    session.clear();

    return Results.html();

}
</pre></div>
</section><section>
<h2><a name="Session_Expiry"></a>Session Expiry</h2>
<p>You can set an expiry time on sessions.  The expiry time is checked every time
a request is made.  If the current time is past the expiry time, the session is
cleared.  By default no expiry time is set, but one can be configured in
<code>conf/application.conf</code> with the
<code>application.session.expire_time_in_seconds</code> property (see below).  It can
also be set in code using <code>setExpiryTime()</code>:</p>

<div>
<pre class="prettyprint">
public Result login(@Param(&quot;rememberMe&quot;) Boolean rememberMe,
                    Session session) {

    if (rememberMe != null &amp;&amp; rememberMe) {
        // Set the expiry time 30 days (in milliseconds) in the future
        session.setExpiryTime(30 * 24 * 60 * 60 * 1000L);
    } else {
        // Set the expiry time 1 hour in the future
        session.setExpiryTime(60 * 60 * 1000L);
    }

    return Results.html();
}
</pre></div>
</section><section>
<h2><a name="Disabling_secure_.28HTTPS.29_flag_for_sessions_during_development"></a>Disabling secure (HTTPS) flag for sessions during development</h2>
<p>By default, Ninja restricts session cookies to secure (HTTPS) connections.  This is
<i>highly recommended</i> in production mode, but prevents using and testing sessions
with HTTP during development.  This restriction can be removed only in dev mode
by adding the following to your configuration file at <code>conf/application.conf</code>.
Please note that secure (HTTPS) will still be required in testing or production mode.</p>

<div>
<pre class="prettyprint">
# allow session cookies over http in dev mode
%dev.application.session.transferred_over_https_only = false
</pre></div>
</section><section>
<h2><a name="Session_configuration"></a>Session configuration</h2>
<p>There are several properties in the configuration file at <code>conf/application.conf</code>
that will change the default behavior of sessions.</p>
<p>The prefix used for all Ninja cookies. By default, this is &#x201c;NINJA&#x201d;. For example,
to use a cookie prefix of &#x201c;MYAPP&#x201d;:</p>

<div>
<pre class="prettyprint">
application.cookie.prefix = MYAPP
</pre></div>

<p>The domain for all cookies (including session cookies). For example, to make
cookies valid for all domains ending with &#x2018;.example.com&#x2019;, e.g. foo.example.com
and bar.example.com:</p>

<div>
<pre class="prettyprint">
application.cookie.domain = .example.com
</pre></div>

<p>The time until a session expires (in seconds).  By default, a session does not
have an expiry time set.  However, the browser may expire the session cookie,
typically after the browser is closed (this can vary based on browser settings).
To set a session to expire after one minute of inactivity:</p>

<div>
<pre class="prettyprint">
application.session.expire_time_in_seconds = 60
</pre></div>

<p>To send a session cookie to the user, but only if the data changed.  By default,
this is set to true.  To send the session cookie data on every response, set
this value to false:</p>

<div>
<pre class="prettyprint">
application.session.send_only_if_changed = false
</pre></div>

<div class="alert alert-info">
When setting the <code>application.session.expire_time_in_seconds</code> property
in conjunction with <code>application.session.send_only_if_changed = true</code>,
the expiration seconds are no longer the &quot;time of inactivity&quot;, but a hard
expiration time after the last Set-Cookie is sent to the client. For example,
with expire_time_in_seconds set to 60 and send_only_if_changed set to true, a
user's logged-in session cookie will simply expire (unless new session values are
added/modified within the expiry time frame) in 60 seconds no matter how many page loads
he does. When send_only_if_changed is false, the session cookie and its expiration
time is refreshed on every HTTP response.
</div>

<p>The <code>application.session.http_only</code> property can be used to mark the
session cookie as HTTP Only when sent over HTTP/HTTPS.  On supported browsers, the
HTTP Only flag will prevent JavaScript from accessing the session cookie.  This
restriction mitigates but does not eliminate the threat of session cookie theft
via cross-site scripting (XSS).  To disable this flag:</p>

<div>
<pre class="prettyprint">
application.session.http_only = false
</pre></div></section>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2023
<a href="https://www.ninjaframework.org">ninjaframework</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
