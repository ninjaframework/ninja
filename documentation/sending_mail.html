<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/documentation/sending_mail.md at 2023-12-07
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20231207" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Ninja &#x2013; Sending mail</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script type="text/javascript" src="../js/apache-maven-fluido-1.7.min.js"></script>
<meta name="description"
                  content="Ninja is a full stack web framework for Java.
                    Rock solid, fast and super productive."/>
            <link rel="icon" type="image/png" href="favicon.png" />

            <link href='//fonts.googleapis.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'/>
            <link href='//fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'/>
            <link href='//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'/>

            <script type="text/javascript">

                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-38154034-1']);
                _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();

            </script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/ninjaframework/ninja">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="../.." id="bannerLeft" title="Ninja web framework"><img src="../ninja_logo.png"  alt="Ninja web framework"/></a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2023-12-07</li>
          <li id="projectVersion" class="pull-right">Version: 7.0.1-SNAPSHOT</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Introduction</li>
    <li><a href="../introduction.html" title="The problem we solve"><span class="none"></span>The problem we solve</a></li>
    <li><a href="../high_level_overview.html" title="Ninja - high level overview"><span class="none"></span>Ninja - high level overview</a></li>
    <li><a href="../team.html" title="The team"><span class="none"></span>The team</a></li>
      <li class="nav-header">Commercial support</li>
    <li><a href="../commercial_support/philosophy.html" title="Philosophy"><span class="none"></span>Philosophy</a></li>
    <li><a href="../commercial_support/training.html" title="Training"><span class="none"></span>Training</a></li>
    <li><a href="../commercial_support/support_plans.html" title="Support plans"><span class="none"></span>Support plans</a></li>
    <li><a href="../commercial_support/agile_custom_development.html" title="Custom development"><span class="none"></span>Custom development</a></li>
      <li class="nav-header">Documentation</li>
    <li><a href="../documentation/getting_started/installing_ninja.html" title="Getting Started"><span class="icon-chevron-right"></span>Getting Started</a></li>
    <li><a href="../documentation/basic_concepts/basic_concepts.html" title="Basic concepts"><span class="icon-chevron-right"></span>Basic concepts</a></li>
    <li><a href="../documentation/configuration_and_modes.html" title="Configuration and modes"><span class="none"></span>Configuration and modes</a></li>
    <li><a href="../documentation/html_templating/getting_started.html" title="HTML templating"><span class="icon-chevron-right"></span>HTML templating</a></li>
    <li><a href="../documentation/working_with_json_jsonp.html" title="Working with JSON / JSONP"><span class="none"></span>Working with JSON / JSONP</a></li>
    <li><a href="../documentation/working_with_xml.html" title="Working with XML"><span class="none"></span>Working with XML</a></li>
      <li class="nav-header">Advanced topics</li>
    <li><a href="../documentation/websockets.html" title="Web Sockets"><span class="none"></span>Web Sockets</a></li>
    <li><a href="../documentation/validation.html" title="Validation"><span class="none"></span>Validation</a></li>
    <li><a href="../documentation/content_negotiation.html" title="Content negotiation"><span class="none"></span>Content negotiation</a></li>
    <li><a href="../documentation/uploading_files.html" title="Uploading files"><span class="none"></span>Uploading files</a></li>
    <li><a href="../documentation/scheduler.html" title="Scheduler"><span class="none"></span>Scheduler</a></li>
    <li><a href="../documentation/lifecycle.html" title="Lifecycle"><span class="none"></span>Lifecycle</a></li>
    <li><a href="../documentation/working_with_relational_dbs/jpa.html" title="Working with relational DBs"><span class="icon-chevron-right"></span>Working with relational DBs</a></li>
    <li><a href="../documentation/using_the_cache.html" title="Using the cache"><span class="none"></span>Using the cache</a></li>
    <li><a href="../documentation/internationalization.html" title="Internationalization"><span class="none"></span>Internationalization</a></li>
    <li><a href="../documentation/static_assets.html" title="Static assets"><span class="none"></span>Static assets</a></li>
    <li class="active"><a href="#"><span class="none"></span>Sending mail</a></li>
    <li><a href="../documentation/logging.html" title="Logging"><span class="none"></span>Logging</a></li>
    <li><a href="../documentation/custom_routing.html" title="Custom routing"><span class="none"></span>Custom routing</a></li>
    <li><a href="../documentation/servlet_bridge.html" title="Servlet bridge"><span class="none"></span>Servlet bridge</a></li>
    <li><a href="../documentation/console.html" title="Console application"><span class="none"></span>Console application</a></li>
    <li><a href="../documentation/testing_your_application/getting_started.html" title="Testing"><span class="icon-chevron-right"></span>Testing</a></li>
    <li><a href="../documentation/debugging.html" title="Debugging"><span class="none"></span>Debugging</a></li>
    <li><a href="../documentation/security/getting_started.html" title="Security"><span class="none"></span>Security</a></li>
    <li><a href="../documentation/deployment/getting_started.html" title="Deployment"><span class="icon-chevron-right"></span>Deployment</a></li>
    <li><a href="../documentation/upgrade_guide.html" title="Upgrade guide"><span class="none"></span>Upgrade guide</a></li>
    <li><a href="../apidocs/index.html" title="API docs (JavaDoc)"><span class="none"></span>API docs (JavaDoc)</a></li>
      <li class="nav-header">Ninja Modules</li>
    <li><a href="../documentation/modules.html" title="Overview"><span class="none"></span>Overview</a></li>
      <li class="nav-header">Great community</li>
    <li><a href="https://twitter.com/ninjaframework" class="externalLink" title="@ninjaframework"><span class="none"></span>@ninjaframework</a></li>
    <li><a href="https://groups.google.com/d/forum/ninja-framework" class="externalLink" title="Mailing list"><span class="none"></span>Mailing list</a></li>
    <li><a href="https://github.com/ninjaframework/ninja" class="externalLink" title="Source code"><span class="none"></span>Source code</a></li>
    <li><a href="https://github.com/ninjaframework/ninja/issues" class="externalLink" title="Bug tracker"><span class="none"></span>Bug tracker</a></li>
    <li><a href="../security.html" title="Security issues"><span class="none"></span>Security issues</a></li>
      <li class="nav-header">For developers</li>
    <li><a href="../developer/changelog.html" title="Changelog"><span class="none"></span>Changelog</a></li>
    <li><a href="../developer/roadmap.html" title="Roadmap"><span class="none"></span>Roadmap</a></li>
    <li><a href="../developer/getting_started.html" title="How to contribute"><span class="none"></span>How to contribute</a></li>
</ul>
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="https://www.ninjaframework.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript">asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
    <div id="twitter">
    <a href="https://twitter.com/ninjaframework" class="twitter-follow-button" data-show-count="true" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow ninjaframework</a>
    <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span9" >
<h1>Sending mail</h1><section>
<h2><a name="Introduction"></a>Introduction</h2>
<p>Ninja allows you to send mails in a really simple and straightforward manner.
All you have to do is to add the dependency to ninja-postoffice and
configure your SMTP server in <code>application.conf</code>.</p>
<p>Then you can inject <code>Postoffice</code> and <code>Mail</code> in your application.
This allows you to create a new <code>Mail</code> instance and send
it via the <code>Postoffice</code>.</p></section><section>
<h2><a name="Adding_the_dependency_and_installing_the_module"></a>Adding the dependency and installing the module</h2>
<p>First - add the dependency to your pom.xml:</p>

<div class="source">
<pre class="prettyprint">
&lt;dependency&gt;
    &lt;groupId&gt;org.ninjaframework&lt;/groupId&gt;
    &lt;artifactId&gt;ninja-postoffice&lt;/artifactId&gt;
    &lt;version&gt;NINJA_VERSION_YOU_ARE_USING&lt;/version&gt;
&lt;/dependency&gt;
</pre></div>

<p>and start the module in your Module.java file of your Ninja application via
install(new NinjaPostofficeModule(ninjaProperties)).</p>

<div class="source">
<pre class="prettyprint">
@Singleton
public class Module extends AbstractModule {
    @Override
    protected void configure() { 
        install(new NinjaPostofficeModule());
    }

}
</pre></div>
</section><section>
<h2><a name="Configuration_and_basic_usage"></a>Configuration and basic usage</h2>
<p>onfigure your mail server in application.conf via the following parameters:</p>

<div class="source">
<pre class="prettyprint">
smtp.host=...               // Hostname of the smtp server (e.g. smtp.mycompany.com)
smtp.port=...               // Port of the smtp server  (e.g. 465).
smtp.ssl=...                // Whether to enable SSL (true or false, default is false)
smtp.starttls=...           // Whether to enable STARTTLS (true or false, default is false)
smtp.starttls.required=...  // Whether to enforce using STARTTLS (true or false, default is false)
smtp.user=...               // Username to access the smtp server
smtp.password=...           // The password
smtp.debug=...              // Enable logging of a huge amount of debug information (true or false)
</pre></div>

<p>If you want to send a mail you can inject the Postoffice and a Provider for
Mail into your class.</p>

<div class="source">
<pre class="prettyprint">
public class MailController {

    @Inject
    Provider&lt;Mail&gt; mailProvider;

    @Inject
    Postoffice postoffice;

    public void sendMail() {
    
        Mail mail = mailProvider.get();

        // fill the mail with content:
        mail.setSubject(&quot;subject&quot;);

        mail.setFrom(&quot;from1@domain&quot;);

        mail.addReplyTo(&quot;replyTo1@domain&quot;);
        mail.addReplyTo(&quot;replyTo2@domain&quot;);

        mail.setCharset(&quot;utf-8&quot;);
        mail.addHeader(&quot;header1&quot;, &quot;value1&quot;);
        mail.addHeader(&quot;header2&quot;, &quot;value2&quot;);

        mail.addTo(&quot;to1@domain&quot;);
        mail.addTo(&quot;to2@domain&quot;);

        mail.addCc(&quot;cc1@domain&quot;);
        mail.addCc(&quot;cc2@domain&quot;);

        mail.addBcc(&quot;bcc1@domain&quot;);
        mail.addBcc(&quot;bcc2@domain&quot;);

        mail.setBodyHtml(&quot;bodyHtml&quot;);

        mail.setBodyText(&quot;bodyText&quot;);

        // finally send the mail
		try {
		    postoffice.send(mail);
		} catch (EmailException | AddressException e) {
		    // ...
		}
    }
}
</pre></div>
</section><section>
<h2><a name="Mail_in_development_and_in_testing"></a>Mail in development and in testing</h2>
<p>When Ninja is running in <code>test</code> or <code>dev</code> mode
<code>Postoffice</code> will be implemented by <code>PostofficeMockImpl</code> by default.</p>
<p><code>PostofficeMockImpl</code> does not send mails, but stores mails, so you can check
if they would have been sent in reality via <code>getLastSentMail()</code>.</p>
<p><code>PostofficeMockImpl</code> also prints out emails that would have been sent
to the system.out. This is nice if you are developing your application but
don't want to check your email account to see if something has been sent.</p></section><section>
<h2><a name="Advanced_usage"></a>Advanced usage</h2><section>
<h3><a name="Specifying_own_Postoffice_implementation"></a>Specifying own Postoffice implementation</h3>
<p>You can override the implementation that will be used via the following parameter
in <code>application.conf</code>:</p>

<div class="source">
<pre class="prettyprint">
postoffice.implementation=... // Implementation to use for interface Postoffice
</pre></div>

<p>If you want to use the real SMTP Postoffice in dev mode (and not the mocked
Postoffice by default) you can override that behavior with the parameter:</p>

<div class="source">
<pre class="prettyprint">
%dev.postoffice.implementation=ninja.postoffice.commonsmail.PostofficeCommonsmailImpl
</pre></div></section></section>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2023
<a href="https://www.ninjaframework.org">ninjaframework</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
