<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2018-11-07 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20181107" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Ninja - Uploading files</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.1.min.js"></script>

                          
        
<meta name="description" content="Ninja is a full stack web framework for Java.                     Rock solid, fast and super productive."/>
                      
        
<link rel="icon" href="favicon.png" type="image/png"/>
                      
        
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Titillium+Web" type="text/css"/>
                      
        
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Inconsolata" type="text/css"/>
                      
        
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" type="text/css"/>
                      
        
<script type="text/javascript">var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-38154034-1']);
                _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();</script>
          
                  </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/ninjaframework/ninja">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../.." id="bannerLeft" title="Ninja web framework">
                                                                                                <img src="../ninja_logo.png"  alt="Ninja web framework"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
            
                
                    
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2018-11-07</li>
              <li id="projectVersion" class="pull-right">
                    Version: 6.4.1
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Introduction</li>
                              
      <li>
  
                          <a href="../introduction.html" title="The problem we solve">
          <i class="none"></i>
        The problem we solve</a>
            </li>
                
      <li>
  
                          <a href="../high_level_overview.html" title="Ninja - high level overview">
          <i class="none"></i>
        Ninja - high level overview</a>
            </li>
                
      <li>
  
                          <a href="../team.html" title="The team">
          <i class="none"></i>
        The team</a>
            </li>
                              <li class="nav-header">Commercial support</li>
                              
      <li>
  
                          <a href="../commercial_support/philosophy.html" title="Philosophy">
          <i class="none"></i>
        Philosophy</a>
            </li>
                
      <li>
  
                          <a href="../commercial_support/training.html" title="Training">
          <i class="none"></i>
        Training</a>
            </li>
                
      <li>
  
                          <a href="../commercial_support/support_plans.html" title="Support plans">
          <i class="none"></i>
        Support plans</a>
            </li>
                
      <li>
  
                          <a href="../commercial_support/agile_custom_development.html" title="Custom development">
          <i class="none"></i>
        Custom development</a>
            </li>
                              <li class="nav-header">Documentation</li>
                                                                                                                    
      <li>
  
                          <a href="../documentation/getting_started/installing_ninja.html" title="Getting Started">
          <i class="icon-chevron-right"></i>
        Getting Started</a>
                  </li>
                                                                                                                                                                                                                                    
      <li>
  
                          <a href="../documentation/basic_concepts/basic_concepts.html" title="Basic concepts">
          <i class="icon-chevron-right"></i>
        Basic concepts</a>
                  </li>
                
      <li>
  
                          <a href="../documentation/configuration_and_modes.html" title="Configuration and modes">
          <i class="none"></i>
        Configuration and modes</a>
            </li>
                                                                                                                        
      <li>
  
                          <a href="../documentation/html_templating/getting_started.html" title="HTML templating">
          <i class="icon-chevron-right"></i>
        HTML templating</a>
                  </li>
                
      <li>
  
                          <a href="../documentation/working_with_json_jsonp.html" title="Working with JSON / JSONP">
          <i class="none"></i>
        Working with JSON / JSONP</a>
            </li>
                
      <li>
  
                          <a href="../documentation/working_with_xml.html" title="Working with XML">
          <i class="none"></i>
        Working with XML</a>
            </li>
                              <li class="nav-header">Advanced topics</li>
                              
      <li>
  
                          <a href="../documentation/websockets.html" title="Web Sockets">
          <i class="none"></i>
        Web Sockets</a>
            </li>
                
      <li>
  
                          <a href="../documentation/validation.html" title="Validation">
          <i class="none"></i>
        Validation</a>
            </li>
                
      <li>
  
                          <a href="../documentation/content_negotiation.html" title="Content negotiation">
          <i class="none"></i>
        Content negotiation</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>Uploading files</a>
          </li>
                
      <li>
  
                          <a href="../documentation/scheduler.html" title="Scheduler">
          <i class="none"></i>
        Scheduler</a>
            </li>
                
      <li>
  
                          <a href="../documentation/lifecycle.html" title="Lifecycle">
          <i class="none"></i>
        Lifecycle</a>
            </li>
                                                                  
      <li>
  
                          <a href="../documentation/working_with_relational_dbs/jpa.html" title="Working with relational DBs">
          <i class="icon-chevron-right"></i>
        Working with relational DBs</a>
                  </li>
                
      <li>
  
                          <a href="../documentation/using_the_cache.html" title="Using the cache">
          <i class="none"></i>
        Using the cache</a>
            </li>
                
      <li>
  
                          <a href="../documentation/internationalization.html" title="Internationalization">
          <i class="none"></i>
        Internationalization</a>
            </li>
                
      <li>
  
                          <a href="../documentation/static_assets.html" title="Static assets">
          <i class="none"></i>
        Static assets</a>
            </li>
                
      <li>
  
                          <a href="../documentation/sending_mail.html" title="Sending mail">
          <i class="none"></i>
        Sending mail</a>
            </li>
                
      <li>
  
                          <a href="../documentation/logging.html" title="Logging">
          <i class="none"></i>
        Logging</a>
            </li>
                
      <li>
  
                          <a href="../documentation/custom_routing.html" title="Custom routing">
          <i class="none"></i>
        Custom routing</a>
            </li>
                
      <li>
  
                          <a href="../documentation/servlet_bridge.html" title="Servlet bridge">
          <i class="none"></i>
        Servlet bridge</a>
            </li>
                
      <li>
  
                          <a href="../documentation/console.html" title="Console application">
          <i class="none"></i>
        Console application</a>
            </li>
                                                                                                                                                            
      <li>
  
                          <a href="../documentation/testing_your_application/getting_started.html" title="Testing">
          <i class="icon-chevron-right"></i>
        Testing</a>
                  </li>
                
      <li>
  
                          <a href="../documentation/debugging.html" title="Debugging">
          <i class="none"></i>
        Debugging</a>
            </li>
                
      <li>
  
                          <a href="../documentation/security/getting_started.html" title="Security">
          <i class="none"></i>
        Security</a>
            </li>
                                                                                                                        
      <li>
  
                          <a href="../documentation/deployment/getting_started.html" title="Deployment">
          <i class="icon-chevron-right"></i>
        Deployment</a>
                  </li>
                
      <li>
  
                          <a href="../documentation/upgrade_guide.html" title="Upgrade guide">
          <i class="none"></i>
        Upgrade guide</a>
            </li>
                
      <li>
  
                          <a href="../apidocs/index.html" title="API docs (JavaDoc)">
          <i class="none"></i>
        API docs (JavaDoc)</a>
            </li>
                              <li class="nav-header">Ninja Modules</li>
                              
      <li>
  
                          <a href="../documentation/modules.html" title="Overview">
          <i class="none"></i>
        Overview</a>
            </li>
                              <li class="nav-header">Great community</li>
                              
      <li>
  
                          <a href="https://twitter.com/ninjaframework" class="externalLink" title="@ninjaframework">
          <i class="none"></i>
        @ninjaframework</a>
            </li>
                
      <li>
  
                          <a href="https://groups.google.com/d/forum/ninja-framework" class="externalLink" title="Mailing list">
          <i class="none"></i>
        Mailing list</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/ninjaframework/ninja" class="externalLink" title="Source code">
          <i class="none"></i>
        Source code</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/ninjaframework/ninja/issues" class="externalLink" title="Bug tracker">
          <i class="none"></i>
        Bug tracker</a>
            </li>
                
      <li>
  
                          <a href="../security.html" title="Security issues">
          <i class="none"></i>
        Security issues</a>
            </li>
                              <li class="nav-header">For developers</li>
                              
      <li>
  
                          <a href="../developer/changelog.html" title="Changelog">
          <i class="none"></i>
        Changelog</a>
            </li>
                
      <li>
  
                          <a href="../developer/roadmap.html" title="Roadmap">
          <i class="none"></i>
        Roadmap</a>
            </li>
                
      <li>
  
                          <a href="../developer/getting_started.html" title="How to contribute">
          <i class="none"></i>
        How to contribute</a>
            </li>
            </ul>
                
                    
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="http://www.ninjaframework.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="http://www.ninjaframework.org/ninja-core" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
               
        
        
        <div id="twitter">
    
    <a href="https://twitter.com/ninjaframework" class="twitter-follow-button" data-show-count="true" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow ninjaframework</a>
    <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

        </div>
                   <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Uploading files</h1>
<div class="section">
<h2>Handling multipart/form-data uploads<a name="Handling_multipartform-data_uploads"></a></h2>
<p>Ninja offers direct access to file uploads in your controller method. This is accomplished via the Context object and two of its methods: <tt>context.isMultipart()</tt> to check if we are dealing with a multipart upload and <tt>context.getFileItemIterator()</tt> to iterate through potential files.</p>
<p>Usually you render a form that links to the controller that will handle the upload. In the following case we are using a route to <tt>/upload</tt>.</p>

<div>
<pre class="prettyprint">
&lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; action=&quot;/upload&quot;&gt;
    Please specify file to upload: &lt;input type=&quot;file&quot; name=&quot;upfile&quot;&gt;&lt;br /&gt;
    &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;
&lt;/form&gt;
</pre></div>
<p>Note that you&#x2019;ll be able to still get your other form values inside a proper DTO : <tt>public Result upload(Context context, MyDto formObject, @Param(&#x201c;file&#x201d;) File file) { &#x2026; }</tt>.</p></div>
<div class="section">
<h2>The manual default way<a name="The_manual_default_way"></a></h2>
<p>The controller at <tt>/uploadFinish</tt> will then handle the upload:</p>

<div>
<pre class="prettyprint">
public Result uploadFinish(Context context) throws Exception {

    // Make sure the context really is a multipart context...
    if (context.isMultipart()) {

        // This is the iterator we can use to iterate over the
        // contents of the request.
        FileItemIterator fileItemIterator = context
                .getFileItemIterator();

        while (fileItemIterator.hasNext()) {

            FileItemStream item = fileItemIterator.next();

            String name = item.getFieldName();
            InputStream stream = item.openStream();

            String contentType = item.getContentType();

            if (item.isFormField()) {

                // do something with the form field

            } else {

                // process file as input stream

            }
        }

    }
    
    // We always return ok. You don't want to do that in production ;)
    return Results.ok();

}
</pre></div></div>
<div class="section">
<h2>The integrated new way<a name="The_integrated_new_way"></a></h2>
<p>The controller at <tt>/uploadFinish</tt> can automatically handle the upload, and return either a FileItem, InputStream or File. Using FileItem allows provides access to additional properties, like <tt>getFileName()</tt> to get the original file name sent by the browser. <b>NOTE:</b> By default, the file provider is set to <tt>NoFileItemProvider</tt> - in order to use this new way, you need to configure a file provider as described below.</p>

<div>
<pre class="prettyprint">
public Result uploadFinish(Context context, @Param(&quot;upfile&quot;) FileItem upfile) throws Exception {
}
</pre></div>
<p>or </p>
<div>
<pre class="prettyprint"> public Result uploadFinish(Context context, @Param(&#x201c;upfile&#x201d;) InputStream upfile) throws Exception { } </pre></div> or 
<div>
<pre class="prettyprint"> public Result uploadFinish(Context context, @Param(&#x201c;upfile&#x201d;) File upfile) throws Exception { } </pre></div> or 
<div>
<pre class="prettyprint"> public Result uploadFinish(Context context) throws Exception {  FileItem upfile = context.getParameterAsFileItem(&#x201c;upfile&#x201d;); } </pre></div>
<div class="section">
<h3>In-memory or disk based file ?<a name="In-memory_or_disk_based_file_"></a></h3>
<p>Ninja comes with two providers to choose between in-memory and disk file for storing uploaded content: - <tt>MemoryFileItemProvider</tt>, to stores the file bytes into memory - <tt>DiskFileItemProvider</tt>, to stores the file content to disk in a temporary folder, that can be set using the <tt>uploads.temp_folder</tt> ninja property</p>
<p>In all case, you can limit the size of each file using <tt>uploads.max_file_size</tt> and the total size of all files using <tt>uploads.max_total_size</tt> ninja properties.</p>

When using disk base storage, uploaded files are automatically deleted at the end of the request, to prevent file system exhaustion. Because of this, you must copy (or move) the file somewhere else before the end of the request if you want to keep it fo a later usage.
</div>
<div class="section">
<h3>Configure the file provider to use<a name="Configure_the_file_provider_to_use"></a></h3>
<p>Ninja let&#x2019;s you configure the file provider to use at different places: - in a module, using a bind to configure a default provider - in a controller class, to override the default&#x2019;s provider configured in the module - in a controller method, to override the class or module provider</p>
<p>By default, the provider is set to <tt>NoFileItemProvider</tt>, who simply reverts to the manual way of handling file.</p>
<p>To define a provider in a module, simply use a bind: </p>
<div>
<pre class="prettyprint"> bind(FileItemProvider.class).to(MemoryFileItemProvider.class) </pre></div>
<p>To define a provider in a controller class and/or method, use an annotation:</p>

<div>
<pre class="prettyprint">
@FileProvider(DiskFileItemProvider.class)
@Singleton
public class MyController {
    @FileProvider(MemoryFileItemProvider.class)
    public Result myRouteMethod() {
        // This will use the MemoryFileItemProvider defined at method level
    }
    public Result myOtherRouteMethod() {
        // This will use the DiskFileItemProvider defined at class level
    }
}
</pre></div></div></div>
<div class="section">
<h2>Advanced usage<a name="Advanced_usage"></a></h2>
<p>Ninja uses Apache Commons-upload to implement the upload functionality. Therefore you can also refer to their excellent manual for more information at: <a class="externalLink" href="http://commons.apache.org/proper/commons-fileupload/">http://commons.apache.org/proper/commons-fileupload/</a></p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2018
                        <a href="http://www.ninjaframework.org">ninjaframework</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
